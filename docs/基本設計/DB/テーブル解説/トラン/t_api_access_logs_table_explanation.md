# `t_api_access_logs` テーブル構成の解説

このテーブルは、ユーザーまたはシステムによるAPI呼び出し履歴を記録するトランザクションテーブルです。セキュリティ監査やパフォーマンス分析に利用されます。

| カラム名         | 型          | 説明                                                       | NULL許容 |
|------------------|-------------|--------------------------------------------------------------|----------|
| `id`             | `UUID`      | APIログレコードの識別子。主キー。                          | ❌       |
| `user_id`        | `UUID`      | 呼び出しを行ったユーザーID（匿名呼び出し時はNULL）。      | ⭕       |
| `endpoint`       | `TEXT`      | アクセスされたAPIエンドポイント（例：`/auth/login`）。    | ❌       |
| `method`         | `VARCHAR`   | HTTPメソッド（GET, POST, PUT, DELETEなど）。               | ❌       |
| `status_code`    | `INTEGER`   | HTTPレスポンスステータスコード（例：200, 401, 500など）。| ❌       |
| `request_time`   | `TIMESTAMP` | リクエスト受信時刻。                                       | ⭕（DEFAULTあり） |
| `response_time_ms` | `INTEGER` | レスポンスまでの所要時間（ミリ秒単位）。                  | ⭕       |
| `ip_address`     | `INET`      | クライアントのIPアドレス。                                 | ⭕       |
| `user_agent`     | `TEXT`      | ブラウザまたはクライアント情報（User-Agent ヘッダ）。      | ⭕       |

---

## 備考

- エンドポイント単位での呼び出し状況、成功／失敗の統計情報収集に有用です。
- APIのパフォーマンス分析（ボトルネック特定）にも使用できます。
- 異常な呼び出し頻度や不正IPからのアクセスなど、セキュリティ監視用途としても重要です。
- データ量が膨大になる可能性があるため、一定期間でのローテーションやアーカイブも推奨されます。
